<div class="actions">
  <button mat-raised-button (click)="newGroup()">
    <div class="action-btn">
      <i class="material-icons btn-icon">add</i>
      <div class="action-text">Add Group...</div>
    </div>
  </button>
</div>

<div class="filter">
  <mat-form-field>
    <input matInput (keyup)="updateUI()" [(ngModel)]="query.filter" placeholder="Filter">
    <mat-hint>Filter results by group name</mat-hint>
    <mat-hint align="end">{{dataSource.filteredData.length}} results</mat-hint>
  </mat-form-field>
</div>

<div class="list-container">
  <div class="list-header" [ngClass]="{'list-header-scrolled':showScrollBar}">
    <div class="header group-name">
      Name
    </div>
    <div class="header group-description">
      Desciption
    </div>
    <div class="header group-actions">
      Actions
    </div>
  </div>

  <div class="list-content">
    <cdk-virtual-scroll-viewport itemSize="40" #content class="list-content">
      <div *cdkVirtualFor="let group of dataSource; templateCacheSize: 0; trackBy: trackByFn.bind(this)" class="list-item">
        <div class="icon-cell group-name" [ngClass]="{'active-job': selectedGroup == group.name}">
          <i class="material-icons cell-icon color-icon">category</i>
          <div class="cell-text color-text" *ngIf="selectedGroupName !== group.name" (click)="getNodes(group.name)">{{group.name}}</div>
          <mat-form-field *ngIf="selectedGroupName == group.name" class="edit-input">
            <input matInput [(ngModel)]="editGroup.name">
          </mat-form-field>
        </div>

        <div class="icon-cell group-description">
          <i class="material-icons cell-icon">notes</i>
          <div class="cell-text" *ngIf="selectedGroupName !== group.name">{{group.description}}</div>
          <mat-form-field *ngIf="selectedGroupName == group.name" class="edit-input">
            <input matInput [(ngModel)]="editGroup.description">
          </mat-form-field>
        </div>

        <div class="icon-cell group-actions">
          <div class="flex-vcenter" *ngIf="group.defaultGroup"> - </div>
          <div class="flex-vcenter" *ngIf="!group.defaultGroup && !(selectedGroupName == group.name)">
            <i class="material-icons cell-icon color-icon" (click)="edit(group)">edit</i>
            <i class="material-icons cell-icon delete-icon">delete</i>
          </div>
          <div class="flex-vcenter" *ngIf="selectedGroupName == group.name">
            <i class="material-icons cell-icon color-icon" (click)="saveEdit()">cached</i>
              <i class="material-icons cell-icon delete-icon" (click)="cancelEdit()">close</i>
          </div>
        </div>
      </div>
    </cdk-virtual-scroll-viewport>
    <app-scroll-to-top [scrolled]="scrolled" [targetEle]="content"></app-scroll-to-top>

    <div class="list-loading" *ngIf="empty">
      <mat-spinner></mat-spinner>
    </div>
  </div>
</div>

<app-loading-progress-bar [hidden]="!loading || !scrolled" class="virtual-scroll-loading"></app-loading-progress-bar>